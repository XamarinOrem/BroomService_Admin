@model BroomServiceWeb.ViewModels.CategoryViewModel
@using BroomServiceWeb.Resources

@{
    ViewBag.Title = "Add Service";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<h2 class="heading-top">@TempData["Title"]</h2>

<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-title">
                <a href="@Url.Action("CategoryList", "Category")"><i class="fa fa-arrow-left"></i><span>@Resource.service_list</span></a>
            </div>
            <div class="card-body">
                <div class="basic-elements">

                    @using (Html.BeginForm("AddCategory", "Category", FormMethod.Post, new { @class = "login-form", enctype = "multipart/form-data" }))
                    {
                    <form>
                        @if (Model == null)
                        {
                            <input type="hidden" name="CategoryId" id="CategoryId" />
                        }
                        else
                        {
                            <input value="@Model.Id" type="hidden" name="CategoryId" id="CategoryId" />
                        }

                        <div class="form-group">
                            <label>@Resource.image</label>
                            <br />
                            @if (Model != null && !string.IsNullOrEmpty(Model.Picture))
                            {
                                <img id="img_Picture" height="100" width="100"
                                     src="~/Images/Category/@Model.Picture" data-zoom-image="~/Images/Category/@Model.Picture" />

                            }
                            else
                            {
                                <img id="img_Picture" height="100" width="100"
                                     src="~/Content/images/image_placeholder.jpg" />
                            }


                            <input type="file" title="search image" id="file" name="file" style="margin-top:10px" />
                        </div>

                        <div class="form-group">
                            <label>@Resource.icon</label>
                            <br />
                            @if (Model != null && !string.IsNullOrEmpty(Model.Icon))
                            {
                                <img id="img_Icon" height="100" width="100"
                                     src="~/Images/Category/@Model.Icon" data-zoom-image="~/Images/Category/@Model.Icon" />

                            }
                            else
                            {
                                <img id="img_Icon" height="100" width="100"
                                     src="~/Content/images/image_placeholder.jpg" />
                            }


                            <input type="file" title="search image" id="fileIcon" name="fileIcon" style="margin-top:10px" />
                        </div>

                        <div class="form-group">
                            <label>@Resource.name </label>
                            @Html.TextBoxFor(m => m.Name, new { @class = "form-control", placeholder = Resource.enter_name })
                            @Html.ValidationMessageFor(m => m.Name, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.name (@Resource.french)</label>
                            @Html.TextBoxFor(m => m.Name_French, new { @class = "form-control", placeholder = Resource.enter_name })
                            @Html.ValidationMessageFor(m => m.Name_French, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.name (@Resource.hebrew)</label>
                            @Html.TextBoxFor(m => m.Name_Hebrew, new { @class = "form-control", placeholder = Resource.enter_name })
                            @Html.ValidationMessageFor(m => m.Name_Hebrew, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.name (@Resource.russian)</label>
                            @Html.TextBoxFor(m => m.Name_Russian, new { @class = "form-control", placeholder = Resource.enter_name })
                            @Html.ValidationMessageFor(m => m.Name_Russian, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.description</label>
                            @Html.TextAreaFor(m => m.Description, new { @class = "form-control", placeholder = Resource.enter_description })
                            @Html.ValidationMessageFor(m => m.Description, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.description (@Resource.french)</label>
                            @Html.TextAreaFor(m => m.Description_French, new { @class = "form-control", placeholder = Resource.enter_description })
                            @Html.ValidationMessageFor(m => m.Description_French, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.description (@Resource.hebrew)</label>
                            @Html.TextAreaFor(m => m.Description_Hebrew, new { @class = "form-control", placeholder = Resource.enter_description })
                            @Html.ValidationMessageFor(m => m.Description_Hebrew, "", new { @class = "text-danger", required = "required" })
                        </div>

                        <div class="form-group">
                            <label>@Resource.description (@Resource.russian)</label>
                            @Html.TextAreaFor(m => m.Description_Russian, new { @class = "form-control", placeholder = Resource.enter_description })
                            @Html.ValidationMessageFor(m => m.Description_Russian, "", new { @class = "text-danger", required = "required" })
                        </div>


                        <div class="form-group">
                            <label>@Resource.display_order</label>
                            @Html.TextBoxFor(m => m.DisplayOrder, new { @class = "form-control", placeholder = Resource.enter_display_order, @type = "Number" })
                            @Html.ValidationMessageFor(m => m.DisplayOrder, "", new { @class = "text-danger", required = "required" })
                        </div>
                        @*<div class="form-group">
            <label>Has Price</label>
            <br />
            @Html.CheckBoxFor(m => m.HasPrice, new { @style = "height:20px;width:20px" })
        </div>*@
                        <div class="form-group">
                            <label>@Resource.for_workers</label>
                            <br />
                            @Html.CheckBoxFor(m => m.ForWorkers, new { @style = "height:20px;width:20px" })
                        </div>
                        <button type="submit" class="btn btn-primary submit-button">@Resource.submit</button>
                    </form>


                        <br />
                        if (TempData["ErrorMsg"] != null)
                        {
                            <div class="alert alert-danger" role="alert">
                                @TempData["ErrorMsg"]
                            </div>
                        }
                        if (TempData["SuccessMsg"] != null)
                        {
                            <div class="alert alert-success" role="alert">
                                @TempData["SuccessMsg"]
                            </div>
                        }
                    }
                </div>
            </div>
        </div>
    </div>
</div>


<!-- /.login-box-body -->
<script type="text/javascript"
        src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>

<script src="https://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript">

    $(document).ready(function () {

        $('#file').on('change', function () {

            var input = this;
            var url = $(this).val();
            var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
            if (input.files && input.files[0] && (ext == "gif" || ext == "png" || ext == "jpeg" || ext == "jpg")) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#img_Picture').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
            else {
                $('#img_Picture').attr('src', '../Template/imgs/user_profle.png');
            }
        });

        $('#fileIcon').on('change', function () {

            var input = this;
            var url = $(this).val();
            var ext = url.substring(url.lastIndexOf('.') + 1).toLowerCase();
            if (input.files && input.files[0] && (ext == "gif" || ext == "png" || ext == "jpeg" || ext == "jpg")) {
                var reader = new FileReader();

                reader.onload = function (e) {
                    $('#img_Icon').attr('src', e.target.result);
                }
                reader.readAsDataURL(input.files[0]);
            }
            else {
                $('#img_Icon').attr('src', '../Template/imgs/user_profle.png');
            }
        });
    });
    $("form").submit(function (e) {

        var catId = $("#CategoryId").val();
        if (catId == '' || catId == 0) {
            var imgIcon = $('#img_Icon').attr('src');
            var imgPicture = $('#img_Picture').attr('src');

            if ($('#file').get(0).files.length === 0 && imgPicture == '/Content/images/image_placeholder.jpg') {
                alert("Choose Image");
                e.preventDefault();
                return false;
            }
            if ($('#fileIcon').get(0).files.length === 0 && imgIcon == '/Content/images/image_placeholder.jpg') {
                alert("Choose Icon");
                e.preventDefault();
                return false;
            }
        }
    });
</script>


